

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Writing a Twitter Bot to post temperature updates - Home</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Home">
<meta property="og:title" content="Writing a Twitter Bot to post temperature updates">


  <link rel="canonical" href="https://lukasbrunner.github.io/misc/twitter_bot">
  <meta property="og:url" content="https://lukasbrunner.github.io/misc/twitter_bot">



  <meta property="og:description" content="">



  <meta name="twitter:site" content="@luki_brunner">
  <meta name="twitter:title" content="Writing a Twitter Bot to post temperature updates">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="https://lukasbrunner.github.io/misc/twitter_bot">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  












  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Lukas Brunner",
      "url" : "https://lukasbrunner.github.io",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://lukasbrunner.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Home Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://lukasbrunner.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://lukasbrunner.github.io/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://lukasbrunner.github.io/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://lukasbrunner.github.io/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://lukasbrunner.github.io/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://lukasbrunner.github.io/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://lukasbrunner.github.io/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://lukasbrunner.github.io/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://lukasbrunner.github.io/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://lukasbrunner.github.io/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://lukasbrunner.github.io/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://lukasbrunner.github.io/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://lukasbrunner.github.io/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://lukasbrunner.github.io/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="https://lukasbrunner.github.io/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="https://lukasbrunner.github.io/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://lukasbrunner.github.io/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://lukasbrunner.github.io/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://lukasbrunner.github.io/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://lukasbrunner.github.io/">Home</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/research/">Research</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/cv/">CV</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/open_science/">Open Science</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/misc/">Misc</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://lukasbrunner.github.io/contact/">Contact</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="https://lukasbrunner.github.io/images/picture_formal1_q.jpg" class="author__avatar" alt="Dr. Lukas Brunner">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Dr. Lukas Brunner</h3>
    <p class="author__bio">Senior Scientist in the group for Climate Dynamics and Modelling</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
      
        
          <li><a href="https://www.univie.ac.at" target="_blank"><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> University of Vienna</a></li>
        
      
      
      
      
       
      
        <li><a href="https://twitter.com/luki_brunner" target="_blank"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
      
      
      
      
      
        <li><a href="https://github.com/lukasbrunner" target="_blank"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
        <li><a href="https://www.stackoverflow.com/users/2699929/lukas" target="_blank"><i class="fab fa-fw fa-stack-overflow" aria-hidden="true"></i> Stackoverflow</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.ch/citations?user=dHMZRfwAAAAJ&hl=en" target="_blank"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
        <li><a href="https://orcid.org/0000-0001-5760-4524" target="_blank"><i class="ai ai-orcid-square ai-fw"></i> ORCID</a></li>
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Writing a Twitter Bot to post temperature updates">
    <meta itemprop="description" content="">
    
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Writing a Twitter Bot to post temperature updates
</h1>
          
        

        


        

        </header>
      

      <section class="page__content" itemprop="text">
        <!-- Nice Twitter integration does not seem to be possible: -->
<!-- - https://stackoverflow.com/questions/49085236/cant-render-twitter-stream-in-github-pages -->
<!-- I've also tried this: -->
<!-- - https://github.com/rob-murray/jekyll-twitter-plugin -->

<p>To the <a href="https://twitter.com/tas_to_date" target="_blank">Bot on Twitter</a>.</p>

<p>It all started with a family discussion over Easter 2021 where my parents could not decide if 2021 has been really cold or really warm in Austria so far. So I did the only reasonable thing and started making plots. I compared mean temperature from the beginning of the year until Easter to the same period in past years using data from ERA5. As seen in the figure below Austrian mean temperatures in 2021 until beginning of April where below the mean of the last 11 years but still 1.5°C above the 1950-1999 baseline.</p>

<p><img src="/images/temperature_todate_2021-04-04.png" width="80%" height="80%" /></p>

<p>Then I generalise it to any end date (i.e., mean temperature from January 1st to XX) in what I started calling year-to-date temperature. I also added to option to calculate the metric for different regions. As a test bed I used the regions defined for the latest sixth IPCC assessment report (AR6). The animation below shows the example of global temperature until end of April.</p>

<p><img src="/images/temperature_todate_2021-04-28.gif" width="80%" height="80%" /></p>

<p>Next I started to automate things using the very convenient <a href="https://era5cli.readthedocs.io/" target="_blank">era5cli</a> and <a href="https://en.wikipedia.org/wiki/Cron" target="_blank">cron</a> to download ERA5 (using the <a href="https://confluence.ecmwf.int/display/CKB/How+to+download+ERA5" target="_blank">ERA5 API</a>). My experience from this is that ERA5 is about 2 weeks behind real time which I find pretty impressive for a global reanalysis. Here is an example to download all available days from the current month and year in hourly resolution and then resample them to daily using <a href="https://code.mpimet.mpg.de/projects/cdo" target="_blank">cdo</a>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">year</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> +%Y<span class="si">)</span>  <span class="c"># current year</span>
<span class="nv">month</span><span class="o">=</span><span class="si">$(</span><span class="nb">date</span> +%m<span class="si">)</span>  <span class="c"># current month</span>
era5cli <span class="s2">"hourly"</span> <span class="nt">--variables</span> <span class="s2">"2m_temperature"</span> <span class="nt">--startyear</span> <span class="nv">$year</span> <span class="nt">--months</span> <span class="nv">$month</span> <span class="nt">--outputprefix</span> era5-<span class="k">${</span><span class="nv">month</span><span class="k">}</span><span class="o">)</span>
<span class="c"># define fn &amp; fn_new</span>
cdo daymean <span class="nv">$fn</span> <span class="nv">$fn_new</span>
</code></pre></div></div>

<p>I use a similar approach to update the plots in a directory. I’ve recently updated the layout of the plots a bit but haven’t managed to clean to code up to a point where I think it is clean and documented enough to publish it. But one of these days… Here is mean temperature in the first half of 2021 for the Mediterranean in the new layout:</p>

<p><img src="/images/temperature_todate_2021-06-30.png" width="80%" height="80%" /></p>

<p>Finally, I started to play around with the <a href="https://developer.twitter.com/en/docs/twitter-api" target="_blank">Twitter API</a> and applied for a developer account. I used the Python <a href="https://www.tweepy.org/" target="_blank">Tweepy</a> package, which makes automated tweeting pretty easy. At the core it is really only a couple of lines:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tweepy</span>

<span class="c1"># ...
</span>
<span class="k">def</span> <span class="nf">tweet</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="n">auth</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">OAuthHandler</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span> <span class="n">consumer_key_secret</span><span class="p">)</span>
    <span class="n">auth</span><span class="p">.</span><span class="n">set_access_token</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">access_token_secret</span><span class="p">)</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">tweepy</span><span class="p">.</span><span class="n">API</span><span class="p">(</span><span class="n">auth</span><span class="p">)</span>
    <span class="n">media</span> <span class="o">=</span> <span class="n">api</span><span class="p">.</span><span class="n">media_upload</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
    <span class="n">api</span><span class="p">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">media_ids</span><span class="o">=</span><span class="p">[</span><span class="n">media</span><span class="p">.</span><span class="n">media_id</span><span class="p">])</span>
</code></pre></div></div>

<p><img src="/images/twitter_bot.png" width="80%" height="80%" /></p>

        
      </section>

      <footer class="page__meta">
        
        




      </footer>

      


  <nav class="pagination">
    
      <a href="https://lukasbrunner.github.io/misc/preenact" class="pagination--pager" title="Preenacting Climate Scenarios: an artistic interpretations to what could happen to our climate
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/"></a>
<!-- end custom footer snippets -->

        

<!-- <div class="page__footer-follow"> -->
<!--   <ul class="social-icons"> -->
<!--      -->
<!--       <li><strong>Follow:</strong></li> -->
<!--      -->
<!--      -->
<!--       <li><a href="https://twitter.com/luki_brunner"><i class="fab fa-twitter-square" aria-hidden="true"></i> Twitter</a></li> -->
<!--      -->
<!--      -->
<!--      -->
<!--       <li><a href="http://github.com/lukasbrunner"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li> -->
<!--      -->
<!--      -->
<!--     <li><a href="https://lukasbrunner.github.io/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li> -->
<!--   </ul> -->
<!-- </div> -->

<div class="page__footer-copyright">
  <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a>
  The content of this webpage is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a> by
  Lukas Brunner (2021). Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>. <a href="/impressum"><b>Impressum</b></a></div>

      </footer>
    </div>

    <script src="https://lukasbrunner.github.io/assets/js/main.min.js"></script>





  </body>
</html>

